/*!
 * ShakeebJustify (Poetry Justification for Urdu / Nastaliq)
 * Author: Shakeeb Ahmad
 * Website: https://shakeeb.in
 * Version: 1.0.9
 * License: MIT
 */
!function(t){var e=["1col","2col"];function n(t){var e=t.cloneNode(!0);return e.querySelectorAll("br").forEach(function(t){t.replaceWith("\n")}),e.querySelectorAll("p, div, li").forEach(function(t){t.append("\n")}),e.textContent.replace(/\n\s*\n+/g,"\n").trim().split("\n").filter(Boolean)}function o(t){return t+'<span class="sj-nl">\n</span>'}function r(t){return"<tr><td>"+o(t)+"</td></tr>"}function a(t,e){return"<tr><td>"+o(t||"")+'</td><td class="spacer-cell"></td><td>'+o(e||"")+"</td></tr>"}function c(t){return t?'<tr class="spacer"><td colspan="3"></td></tr>':'<tr class="spacer"><td></td></tr>'}function i(t,e){return'<table class="shakeeb-justify '+t+'">'+e+"</table>"}function l(t,e,o){var a=function(t,e){for(var n=[],o=0;o<t.length;)for(var r=0;r<e.length&&o<t.length;r++)n.push(t.slice(o,o+e[r])),o+=e[r];return n}(n(t),e),l="";a.forEach(function(t,e){t.forEach(function(t){l+=r(t)}),e<a.length-1&&(l+=c())}),t.innerHTML=i(o||"sher",l)}function s(t,e,o){var c=n(t),i=e.reduce(function(t,e){return t+e.count},0);c.length%i!==0&&console.warn("[ShakeebJustify] Line count ("+c.length+") is not a multiple of pattern size ("+i+")",t);for(var l=0,s="";l<c.length;){for(var u=0;u<e.length&&l<c.length;u++){var d=e[u],f=c.slice(l,l+d.count),p="",h=(l+=d.count)>=c.length&&u===e.length-1;if("2col"===d.mode){for(var m=0;m<f.length;m+=2)p+=a(f[m],f[m+1]);s+='<table class="shakeeb-justify sher2"'+(h?"":' style="margin-bottom:15px"')+">"+p+"</table>"}else f.forEach(function(t){p+=r(t)}),s+='<table class="shakeeb-justify '+(o||"mixed")+'"'+(h?"":' style="margin-bottom:15px"')+">"+p+"</table>"}0}t.innerHTML=s}function u(t,e){navigator.clipboard.writeText(t).then(function(){e.classList.add("copied");var t=e.innerHTML;e.innerHTML="âœ“",setTimeout(function(){e.classList.remove("copied"),e.innerHTML=t},1500)}).catch(function(t){console.error("Copy failed:",t)})}function d(){!function(){if(!document.getElementById("shakeeb-justify-style")){var t=document.createElement("style");t.id="shakeeb-justify-style",t.textContent=".shakeeb-justify{border-collapse:collapse;margin:0 auto;position:relative;direction:rtl}.shakeeb-justify td{text-align:justify;text-align-last:justify;direction:rtl;line-height:1.5em;unicode-bidi:plaintext}.shakeeb-justify.sher2 td{width:46%}.shakeeb-justify.sher2 td.spacer-cell{width:10%}.shakeeb-justify tr.spacer td{height:15px;padding:0}.shakeeb-justify .sj-nl{position:absolute;left:-9999px;font-size:0;white-space:pre}.sj-copy-wrap{position:relative}.sj-copy-btn{position:absolute;top:0;left:0;z-index:10;background:#333;color:#fff;border:0;border-radius:4px;padding:6px 8px;cursor:pointer;opacity:0;transition:opacity .2s;font-size:14px;line-height:1}.sj-copy-wrap:hover .sj-copy-btn,.sj-copy-wrap:focus-within .sj-copy-btn{opacity:.8}.sj-copy-btn:hover{opacity:1!important;background:#000}.sj-copy-btn.copied{background:#22c55e}.shakeeb-justify tr{position:relative;direction:rtl}.sj-row-copy{position:absolute;left:-30px;top:50%;transform:translateY(-50%);background:#333;color:#fff;border:0;border-radius:3px;padding:4px 6px;cursor:pointer;opacity:0;transition:opacity .2s;font-size:12px;line-height:1}.shakeeb-justify tr:hover .sj-row-copy{opacity:.7}.sj-row-copy:hover{opacity:1!important;background:#000}.sj-row-copy.copied{background:#22c55e}.shakeeb-justify tr.spacer .sj-row-copy{display:none}",document.head.appendChild(t)}}(),document.querySelectorAll(".sher").forEach(function(t){t.innerHTML=function(t,e,n){if(!t.length)return"";var o="";return t.forEach(function(n,a){o+=r(n),e&&(a+1)%e===0&&a<t.length-1&&(o+=c())}),i(n||"sher",o)}(n(t),2,"sher")}),document.querySelectorAll(".sher2").forEach(function(t){t.innerHTML=function(t,e){if(!t.length)return"";for(var n="",o=0;o<t.length;o+=2)n+=a(t[o],t[o+1]),(o+2<t.length||e)&&(n+=c(!0));return i("sher2",n)}(n(t))}),document.querySelectorAll(".mukhammas").forEach(function(t){l(t,[5],"mukhammas")}),document.querySelectorAll(".mukhammas-3-2").forEach(function(t){l(t,[3,2],"mukhammas")}),document.querySelectorAll(".mukhammas-mixed").forEach(function(t){s(t,[{count:4,mode:"2col"},{count:1,mode:"1col"}],"mukhammas")}),document.querySelectorAll(".musaddas").forEach(function(t){l(t,[4,2],"musaddas")}),document.querySelectorAll(".musaddas-6").forEach(function(t){l(t,[6],"musaddas")}),document.querySelectorAll(".musaddas-mixed").forEach(function(t){s(t,[{count:4,mode:"2col"},{count:2,mode:"1col"}],"musaddas")}),document.querySelectorAll("[data-pattern]").forEach(function(t){var e=t.dataset.pattern.split("+").map(function(t){return parseInt(t,10)}).filter(Boolean);e.length&&l(t,e,"custom-pattern")}),document.querySelectorAll("[data-mixed]").forEach(function(t){var n=t.dataset.mixed.split(",").map(function(t){var n=t.split(":"),o=(n[1]||"1col").trim();return e.indexOf(o)<0&&(console.warn('[ShakeebJustify] Invalid mode "'+o+'". Valid: '+e.join(", ")),o="1col"),{count:parseInt(n[0],10)||0,mode:o}});n&&s(t,n,"custom-mixed")}),document.querySelectorAll("[data-copy]").forEach(function(t){setTimeout(function(){!function(t,e){if(t.classList.add("sj-copy-wrap"),"all"===e||"both"===e){var n=document.createElement("button");n.className="sj-copy-btn",n.innerHTML="ðŸ“‹",n.title="Copy poem",n.onclick=function(e){e.stopPropagation(),u(function(t){var e=t.querySelector(".shakeeb-justify");if(!e)return"";var n=[];return e.querySelectorAll("tr:not(.spacer)").forEach(function(t){t.querySelectorAll("td:not(.spacer-cell)").forEach(function(t){var e=t.textContent.replace(/\n/g,"").trim();e&&n.push(e)})}),n.join("\n")}(t),n)},t.insertBefore(n,t.firstChild)}if("row"===e||"both"===e){var o=t.querySelector(".shakeeb-justify");o&&o.querySelectorAll("tr:not(.spacer)").forEach(function(t){var e=document.createElement("button");e.className="sj-row-copy",e.innerHTML="ðŸ“‹",e.title="Copy line",e.onclick=function(n){n.stopPropagation(),u(function(t){var e=[];return t.querySelectorAll("td:not(.spacer-cell)").forEach(function(t){var n=t.textContent.replace(/\n/g,"").trim();n&&e.push(n)}),e.join("\n")}(t),e)},t.querySelector("td").appendChild(e)})}}(t,t.dataset.copy||"all")},0)}),console.log("%cShakeebJustify v1.0.9 â€” https://shakeeb.in","color: green; font-weight: bold")}t.ShakeebJustify={apply:d},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()}(window);