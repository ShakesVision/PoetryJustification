/*!
 * ShakeebJustify (Poetry Justification for Urdu / Nastaliq)
 * Author: Shakeeb Ahmad
 * Website: https://shakeeb.in
 * Version: 1.0.5
 * License: MIT
 */
!function(){function t(t){const e=t.cloneNode(!0);return e.querySelectorAll("br").forEach(t=>t.replaceWith("\n")),e.querySelectorAll("p, div, li").forEach(t=>t.append("\n")),e.textContent.replace(/\n\s*\n+/g,"\n").trim()}function e(e,n,l="sher"){const a=function(t,e){const n=[];let l=0;for(;l<t.length;)for(let a of e){if(l>=t.length)break;n.push(t.slice(l,l+a)),l+=a}return n}(t(e).split("\n").filter(Boolean),n);let s="";a.forEach((t,e)=>{t.forEach(t=>{s+=`<tr><td>${t}</td></tr>`}),e<a.length-1&&(s+='<tr class="spacer"><td></td></tr>')}),e.innerHTML=`<table class="shakeeb-justify ${l}">${s}</table>`}function n(e,n,l="mixed"){const a=t(e).split("\n").filter(Boolean);let s=0,o="";n.forEach((t,e)=>{const r=a.slice(s,s+t.count);s+=t.count;const c=e===n.length-1;if("2col"===t.mode){let t="";for(let e=0;e<r.length;e+=2)t+=`<tr>\n                        <td>${r[e]||""}</td>\n                        <td class="spacer-cell"></td>\n                        <td>${r[e+1]||""}</td>\n                    </tr>`,e+2<r.length&&(t+='<tr class="spacer"><td colspan="3"></td></tr>');o+=`<table class="shakeeb-justify sher2"${c?"":' style="margin-bottom: 15px;"'}>${t}</table>`}else{let t="";r.forEach((e,n)=>{t+=`<tr><td>${e}</td></tr>`}),o+=`<table class="shakeeb-justify ${l}"${c?"":' style="margin-bottom: 15px;"'}>${t}</table>`}}),e.innerHTML=o}function l(){!function(){if(document.getElementById("shakeeb-justify-style"))return;const t=document.createElement("style");t.id="shakeeb-justify-style",t.textContent="\n            /* Base table styles - namespaced to avoid conflicts */\n            .shakeeb-justify {\n                border-collapse: collapse;\n                margin: 0 auto;\n            }\n\n            /* Common text styles for all poetry elements */\n            .shakeeb-justify td {\n                text-align: justify;\n                text-align-last: justify;\n                direction: rtl;\n                line-height: 1.5em;\n                unicode-bidi: plaintext;\n            }\n\n            /* Two-column layout widths */\n            .shakeeb-justify.sher2 td { width: 46%; }\n            .shakeeb-justify.sher2 td.spacer-cell { width: 10%; }\n\n            /* Spacer row for gaps between stanzas */\n            .shakeeb-justify tr.spacer td {\n                height: 15px;\n                padding: 0;\n            }\n        ",document.head.appendChild(t)}(),document.querySelectorAll(".sher").forEach(e=>e.innerHTML=function(t,e=null,n="sher"){if(!t)return"";const l=t.split("\n").filter(Boolean);let a="";return l.forEach((t,n)=>{a+=`<tr><td>${t}</td></tr>`,e&&(n+1)%e===0&&n<l.length-1&&(a+='<tr class="spacer"><td></td></tr>')}),`<table class="shakeeb-justify ${n}">${a}</table>`}(t(e),2,"sher")),document.querySelectorAll(".sher2").forEach(e=>e.innerHTML=function(t,e=!1){if(!t)return"";const n=t.split("\n").filter(Boolean);let l="";for(let t=0;t<n.length;t+=2)l+=`<tr>\n                <td>${n[t]||""}</td>\n                <td class="spacer-cell"></td>\n                <td>${n[t+1]||""}</td>\n            </tr>`,(t+2<n.length||e)&&(l+='<tr class="spacer"><td colspan="3"></td></tr>');return`<table class="shakeeb-justify sher2">${l}</table>`}(t(e))),document.querySelectorAll(".mukhammas").forEach(t=>e(t,[5],"mukhammas")),document.querySelectorAll(".mukhammas-3-2").forEach(t=>e(t,[3,2],"mukhammas")),document.querySelectorAll(".mukhammas-mixed").forEach(t=>n(t,[{count:4,mode:"2col"},{count:1,mode:"1col"}],"mukhammas")),document.querySelectorAll(".musaddas").forEach(t=>e(t,[4,2],"musaddas")),document.querySelectorAll(".musaddas-6").forEach(t=>e(t,[6],"musaddas")),document.querySelectorAll(".musaddas-mixed").forEach(t=>n(t,[{count:4,mode:"2col"},{count:2,mode:"1col"}],"musaddas")),document.querySelectorAll("[data-pattern]").forEach(t=>{const n=(l=t.dataset.pattern)?l.split("+").map(t=>parseInt(t,10)).filter(Boolean):null;var l;n&&e(t,n,"custom-pattern")}),document.querySelectorAll("[data-mixed]").forEach(t=>{const e=t.dataset.mixed.split(",").map(t=>{const[e,n]=t.split(":");return{count:parseInt(e,10),mode:n}});e&&n(t,e,"custom-mixed")}),console.log("%cShakeebJustify v1.0.5 applied â€” https://shakeeb.in","color: green; font-weight: bold;")}window.ShakeebJustify={apply:l},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l()}();