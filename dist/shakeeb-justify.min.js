/*!
 * ShakeebJustify (Poetry Justification for Urdu / Nastaliq)
 * Author: Shakeeb Ahmad
 * Website: https://shakeeb.in
 * Version: 1.0.6
 * License: MIT
 */
!function(){function t(t){const e=t.cloneNode(!0);return e.querySelectorAll("br").forEach(t=>t.replaceWith("\n")),e.querySelectorAll("p, div, li").forEach(t=>t.append("\n")),e.textContent.replace(/\n\s*\n+/g,"\n").trim()}function e(t){return`${t}<span class="sj-nl">\n</span>`}async function n(t,e){try{await navigator.clipboard.writeText(t),e.classList.add("copied");const n=e.innerHTML;e.innerHTML="âœ“",setTimeout(()=>{e.classList.remove("copied"),e.innerHTML=n},1500)}catch(t){console.error("Copy failed:",t)}}function o(n,o,r="sher"){const s=function(t,e){const n=[];let o=0;for(;o<t.length;)for(let r of e){if(o>=t.length)break;n.push(t.slice(o,o+r)),o+=r}return n}(t(n).split("\n").filter(Boolean),o);let a="";s.forEach((t,n)=>{t.forEach(t=>{a+=`<tr><td>${e(t)}</td></tr>`}),n<s.length-1&&(a+='<tr class="spacer"><td></td></tr>')}),n.innerHTML=`<table class="shakeeb-justify ${r}">${a}</table>`}function r(n,o,r="mixed"){const s=t(n).split("\n").filter(Boolean);let a=0,c="";o.forEach((t,n)=>{const l=s.slice(a,a+t.count);a+=t.count;const i=n===o.length-1;if("2col"===t.mode){let t="";for(let n=0;n<l.length;n+=2)t+=`<tr>\n                        <td>${e(l[n]||"")}</td>\n                        <td class="spacer-cell"></td>\n                        <td>${e(l[n+1]||"")}</td>\n                    </tr>`,n+2<l.length&&(t+='<tr class="spacer"><td colspan="3"></td></tr>');c+=`<table class="shakeeb-justify sher2"${i?"":' style="margin-bottom: 15px;"'}>${t}</table>`}else{let t="";l.forEach((n,o)=>{t+=`<tr><td>${e(n)}</td></tr>`}),c+=`<table class="shakeeb-justify ${r}"${i?"":' style="margin-bottom: 15px;"'}>${t}</table>`}}),n.innerHTML=c}function s(){!function(){if(document.getElementById("shakeeb-justify-style"))return;const t=document.createElement("style");t.id="shakeeb-justify-style",t.textContent="\n            /* Base table styles - namespaced to avoid conflicts */\n            .shakeeb-justify {\n                border-collapse: collapse;\n                margin: 0 auto;\n                position: relative;\n            }\n\n            /* Common text styles for all poetry elements */\n            .shakeeb-justify td {\n                text-align: justify;\n                text-align-last: justify;\n                direction: rtl;\n                line-height: 1.5em;\n                unicode-bidi: plaintext;\n            }\n\n            /* Two-column layout widths */\n            .shakeeb-justify.sher2 td { width: 46%; }\n            .shakeeb-justify.sher2 td.spacer-cell { width: 10%; }\n\n            /* Spacer row for gaps between stanzas */\n            .shakeeb-justify tr.spacer td {\n                height: 15px;\n                padding: 0;\n            }\n\n            /* Hidden newline for proper copy behavior - invisible but copyable */\n            .shakeeb-justify .sj-nl {\n                position: absolute;\n                left: -9999px;\n                font-size: 0;\n                line-height: 0;\n                white-space: pre;\n            }\n\n            /* -------------------- COPY BUTTON STYLES -------------------- */\n            \n            /* Container needs relative positioning for button */\n            .sj-copy-wrap {\n                position: relative;\n            }\n\n            /* Copy all button - appears on container hover */\n            .sj-copy-btn {\n                position: absolute;\n                top: 0;\n                left: 0;\n                z-index: 10;\n                background: #333;\n                color: #fff;\n                border: none;\n                border-radius: 4px;\n                padding: 6px 8px;\n                cursor: pointer;\n                opacity: 0;\n                transition: opacity 0.2s;\n                font-size: 14px;\n                line-height: 1;\n            }\n\n            .sj-copy-wrap:hover .sj-copy-btn,\n            .sj-copy-wrap:focus-within .sj-copy-btn {\n                opacity: 0.8;\n            }\n\n            .sj-copy-btn:hover {\n                opacity: 1 !important;\n                background: #000;\n            }\n\n            .sj-copy-btn.copied {\n                background: #22c55e;\n            }\n\n            /* Row-level copy button */\n            .shakeeb-justify tr {\n                position: relative;\n            }\n\n            .sj-row-copy {\n                position: absolute;\n                left: -30px;\n                top: 50%;\n                transform: translateY(-50%);\n                background: #333;\n                color: #fff;\n                border: none;\n                border-radius: 3px;\n                padding: 4px 6px;\n                cursor: pointer;\n                opacity: 0;\n                transition: opacity 0.2s;\n                font-size: 12px;\n                line-height: 1;\n            }\n\n            .shakeeb-justify tr:hover .sj-row-copy {\n                opacity: 0.7;\n            }\n\n            .sj-row-copy:hover {\n                opacity: 1 !important;\n                background: #000;\n            }\n\n            .sj-row-copy.copied {\n                background: #22c55e;\n            }\n\n            /* Hide row copy on spacer rows */\n            .shakeeb-justify tr.spacer .sj-row-copy {\n                display: none;\n            }\n        ",document.head.appendChild(t)}(),document.querySelectorAll(".sher").forEach(n=>n.innerHTML=function(t,n=null,o="sher"){if(!t)return"";const r=t.split("\n").filter(Boolean);let s="";return r.forEach((t,o)=>{s+=`<tr><td>${e(t)}</td></tr>`,n&&(o+1)%n===0&&o<r.length-1&&(s+='<tr class="spacer"><td></td></tr>')}),`<table class="shakeeb-justify ${o}">${s}</table>`}(t(n),2,"sher")),document.querySelectorAll(".sher2").forEach(n=>n.innerHTML=function(t,n=!1){if(!t)return"";const o=t.split("\n").filter(Boolean);let r="";for(let t=0;t<o.length;t+=2)r+=`<tr>\n                <td>${e(o[t]||"")}</td>\n                <td class="spacer-cell"></td>\n                <td>${e(o[t+1]||"")}</td>\n            </tr>`,(t+2<o.length||n)&&(r+='<tr class="spacer"><td colspan="3"></td></tr>');return`<table class="shakeeb-justify sher2">${r}</table>`}(t(n))),document.querySelectorAll(".mukhammas").forEach(t=>o(t,[5],"mukhammas")),document.querySelectorAll(".mukhammas-3-2").forEach(t=>o(t,[3,2],"mukhammas")),document.querySelectorAll(".mukhammas-mixed").forEach(t=>r(t,[{count:4,mode:"2col"},{count:1,mode:"1col"}],"mukhammas")),document.querySelectorAll(".musaddas").forEach(t=>o(t,[4,2],"musaddas")),document.querySelectorAll(".musaddas-6").forEach(t=>o(t,[6],"musaddas")),document.querySelectorAll(".musaddas-mixed").forEach(t=>r(t,[{count:4,mode:"2col"},{count:2,mode:"1col"}],"musaddas")),document.querySelectorAll("[data-pattern]").forEach(t=>{const e=(n=t.dataset.pattern)?n.split("+").map(t=>parseInt(t,10)).filter(Boolean):null;var n;e&&o(t,e,"custom-pattern")}),document.querySelectorAll("[data-mixed]").forEach(t=>{const e=t.dataset.mixed.split(",").map(t=>{const[e,n]=t.split(":");return{count:parseInt(e,10),mode:n}});e&&r(t,e,"custom-mixed")}),document.querySelectorAll("[data-copy]").forEach(t=>{const e=t.dataset.copy||"all";setTimeout(()=>function(t,e){if(t.classList.add("sj-copy-wrap"),"all"===e||"both"===e){const e=document.createElement("button");e.className="sj-copy-btn",e.innerHTML="ðŸ“‹",e.title="Copy poem",e.addEventListener("click",o=>{o.stopPropagation(),n(function(t){const e=t.querySelector(".shakeeb-justify");if(!e)return"";const n=[];return e.querySelectorAll("tr:not(.spacer)").forEach(t=>{t.querySelectorAll("td:not(.spacer-cell)").forEach(t=>{const e=t.textContent.replace(/\n/g,"").trim();e&&n.push(e)})}),n.join("\n")}(t),e)}),t.insertBefore(e,t.firstChild)}if("row"===e||"both"===e){const e=t.querySelector(".shakeeb-justify");e&&e.querySelectorAll("tr:not(.spacer)").forEach(t=>{const e=document.createElement("button");e.className="sj-row-copy",e.innerHTML="ðŸ“‹",e.title="Copy line",e.addEventListener("click",o=>{o.stopPropagation();const r=function(t){const e=t.querySelectorAll("td:not(.spacer-cell)"),n=[];return e.forEach(t=>{const e=t.textContent.replace(/\n/g,"").trim();e&&n.push(e)}),n.join("\n")}(t);n(r,e)}),t.querySelector("td").appendChild(e)})}}(t,e),0)}),console.log("%cShakeebJustify v1.0.6 applied â€” https://shakeeb.in","color: green; font-weight: bold;")}window.ShakeebJustify={apply:s},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()}();